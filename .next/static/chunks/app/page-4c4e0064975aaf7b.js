(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5893:function(){},2555:function(e,l,a){Promise.resolve().then(a.bind(a,2694))},2694:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return O}});var t=a(7437),r=a(2265),s=e=>{let{selectedClass:l,onClassChange:a,availableClasses:r}=e;return(0,t.jsxs)("div",{className:"flex justify-center mb-4",children:[(0,t.jsx)("label",{htmlFor:"class-filter",className:"mr-2 text-gray-700",children:"Class:"}),(0,t.jsxs)("select",{id:"class-filter",value:l,onChange:a,className:"custom-dropdown border rounded text-gray-700",children:[(0,t.jsx)("option",{value:"",children:"All"}),r.map((e,l)=>(0,t.jsx)("option",{value:e,children:e},l))]})]})},n=()=>(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"font-sans text-4xl mb-3 text-indigo-800",children:"Universal database of objects"}),(0,t.jsx)("h1",{className:"font-sans text-base mb-5 text-gray-900",children:"Upload a photo or video (under 4.5 MB) or search by text"})]}),o=a(6691),i=a.n(o),d=e=>{let{isLoadingResults:l,results:a,getScoreLabel:r,getVideoId:s}=e;return(0,t.jsx)("div",{children:l?(0,t.jsx)("div",{className:"mt-8 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(20)].map((e,l)=>(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"bg-gray-300 h-64 w-full rounded-sm"}),(0,t.jsx)("div",{className:"h-4 bg-gray-300 rounded w-3/4 mt-2"})]},l))}):a.length>0&&(0,t.jsx)("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((e,l)=>{let{score:a}=r(e.score),n=s(e,l);return(0,t.jsxs)("div",{children:["image"===e.metadata.file_type?(0,t.jsx)(i(),{src:e.metadata.s3_presigned_url,alt:"Result",className:"w-full h-auto object-cover mt-2 rounded"}):(0,t.jsx)("div",{className:"video-container mt-2 rounded",children:(0,t.jsxs)("video",{id:n,className:"video-js vjs-default",children:[(0,t.jsx)("source",{src:e.metadata.s3_presigned_url,type:"video/mp4"}),"Your browser does not support the video tag."]})}),(0,t.jsxs)("div",{className:"mt-1 p-2 bg-gray-100 text-gray-800 text-xs rounded shadow break-words",children:[Object.entries(e.metadata).map(e=>{let[l,a]=e;return a&&"file_type"!==l&&"s3_presigned_url"!==l&&"s3_file_name"!==l?(0,t.jsxs)("p",{children:[(0,t.jsxs)("strong",{children:[l.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),":"]})," ",a]},l):null}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Similarity Score:"})," ",a]})]})]},n)})})})};function c(e){return(0,t.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,t.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,t.jsx)("polyline",{points:"21 15 16 10 5 21"})]})}function u(e){return(0,t.jsxs)("svg",{...e,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,t.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})}var m=e=>{let{query:l,handleInputChange:a,handleSubmit:r,handleFileChange:s,isInputEmpty:n,isUploading:o,isSearching:i,clearResults:d,suggestions:m,handleSuggestionClick:b,showSuggestions:h,handleFocus:p,openModal:x}=e;return(0,t.jsxs)("form",{onSubmit:r,className:"flex items-center ",children:[(0,t.jsxs)("div",{className:"flex-grow flex items-center bg-white rounded shadow-md w-3/5 max-w-2xl",children:[(0,t.jsxs)("div",{className:"flex-grow relative",children:[(0,t.jsx)("input",{type:"text",value:l,onChange:a,onFocus:p,placeholder:"Describe the object, or drag in an image or video",className:"w-full flex-grow px-6 py-3 text-gray-700 bg-transparent focus:outline-none",disabled:o||i}),h&&m.length>0&&(0,t.jsx)("div",{className:"absolute left-0 right-0 mt-2 w-full bg-white border rounded shadow-lg max-h-60 overflow-y-auto z-10",children:m.map((e,l)=>(0,t.jsxs)("div",{className:"px-6 py-1.5 hover:bg-gray-100 cursor-pointer text-gray-700 flex items-center",onClick:()=>b(e),children:[(0,t.jsx)(u,{className:"h-4 w-4 mr-3 text-indigo-500"}),e]},l))})]}),(0,t.jsx)("input",{type:"file",accept:"image/*,video/*",onChange:s,style:{display:"none"},id:"upload-input",disabled:o||i}),(0,t.jsx)("label",{htmlFor:"upload-input",className:"cursor-pointer px-4 ".concat(o||i?"text-gray-400":"text-gray-500 hover:text-gray-700"," focus:outline-none"),children:(0,t.jsx)(c,{className:"h-6 w-6"})})]}),(0,t.jsx)("button",{type:"submit",className:"ml-1 px-3 ".concat(n?"text-gray-400 cursor-not-allowed":o||i?"text-gray-400 cursor-wait":"text-gray-500 hover:text-gray-700"," focus:outline-none"),disabled:n||o||i,children:(0,t.jsx)(u,{className:"h-6 w-6 text-indigo-500 hover:text-indigo-700"})}),(0,t.jsx)("button",{type:"button",onClick:x,className:"ml-1 px-3 text-gray-500 hover:text-gray-700 focus:outline-none",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6 text-indigo-500 hover:text-indigo-700",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})})]})},b=a(4829),h=[{value:"",label:"No brand"},{value:"Coca-Cola",label:"Coca-Cola"},{value:"Pepsi",label:"Pepsi"},{value:"7 Up",label:"7 Up"},{value:"Fanta",label:"Fanta"},{value:"Sprite",label:"Sprite"},{value:"Dr Pepper",label:"Dr Pepper"},{value:"Mountain Dew",label:"Mountain Dew"},{value:"Gatorade",label:"Gatorade"},{value:"Aquafina",label:"Aquafina"},{value:"Dasani",label:"Dasani"},{value:"Poland Spring",label:"Poland Spring"},{value:"Evian",label:"Evian"},{value:"Red Bull",label:"Red Bull"},{value:"Monster",label:"Monster"},{value:"Budweiser",label:"Budweiser"},{value:"Bud Light",label:"Bud Light"},{value:"Coors Light",label:"Coors Light"},{value:"Miller Lite",label:"Miller Lite"},{value:"Corona",label:"Corona"},{value:"Heineken",label:"Heineken"},{value:"Blue Moon",label:"Blue Moon"},{value:"Stella Artois",label:"Stella Artois"},{value:"Guinness",label:"Guinness"},{value:"Lays",label:"Lays"},{value:"Doritos",label:"Doritos"},{value:"Cheetos",label:"Cheetos"},{value:"Pringles",label:"Pringles"},{value:"Ruffles",label:"Ruffles"},{value:"Fritos",label:"Fritos"},{value:"Snickers",label:"Snickers"},{value:"M&Ms",label:"M&Ms"},{value:"Twix",label:"Twix"},{value:"Hershey's",label:"Hershey's"},{value:"KitKat",label:"KitKat"},{value:"Skittles",label:"Skittles"},{value:"Chobani",label:"Chobani"},{value:"Yoplait",label:"Yoplait"},{value:"Ben & Jerry's",label:"Ben & Jerry's"},{value:"Haagen-Dazs",label:"Haagen-Dazs"},{value:"Colgate",label:"Colgate"},{value:"Crest",label:"Crest"},{value:"Sensodyne",label:"Sensodyne"},{value:"Aquafresh",label:"Aquafresh"},{value:"Parodontax",label:"Parodontax"},{value:"Close-Up",label:"Close-Up"},{value:"Oral-B",label:"Oral-B"},{value:"Tide",label:"Tide"},{value:"Dawn",label:"Dawn"},{value:"Clorox",label:"Clorox"},{value:"Windex",label:"Windex"},{value:"Amazon",label:"Amazon"},{value:"Walmart",label:"Walmart"},{value:"Target",label:"Target"},{value:"Costco",label:"Costco"},{value:"Whole Foods",label:"Whole Foods"},{value:"Trader Joe's",label:"Trader Joe's"},{value:"Aldi",label:"Aldi"},{value:"Publix",label:"Publix"},{value:"McDonald's",label:"McDonald's"},{value:"Starbucks",label:"Starbucks"},{value:"Subway",label:"Subway"},{value:"Burger King",label:"Burger King"},{value:"Dunkin'",label:"Dunkin'"},{value:"Taco Bell",label:"Taco Bell"},{value:"Other",label:"Other (Specify Below)"}],p=[{value:"red",label:"Red"},{value:"blue",label:"Blue"},{value:"green",label:"Green"},{value:"yellow",label:"Yellow"},{value:"black",label:"Black"},{value:"white",label:"White"},{value:"brown",label:"Brown"},{value:"gray",label:"Gray"},{value:"pink",label:"Pink"},{value:"purple",label:"Purple"},{value:"orange",label:"Orange"},{value:"gold",label:"Gold"},{value:"silver",label:"Silver"},{value:"translucent",label:"Translucent"},{value:"other",label:"Other"}],x=[{value:"aseptic carton",label:"Aseptic Carton"},{value:"gable top carton",label:"Gable Top Carton"},{value:"aluminium can",label:"Aluminium Can"},{value:"cardboard",label:"Cardboard"},{value:"flexible plastic",label:"Flexible Plastic"},{value:"rigid plastic",label:"Rigid Plastic"},{value:"hdpe natural",label:"HDPE Natural"},{value:"hdpe color",label:"HDPE Color"},{value:"paperboard",label:"Paperboard"},{value:"paper cup",label:"Paper Cup"},{value:"pp",label:"PP"},{value:"pet",label:"PET"},{value:"styrofoam",label:"Styrofoam"},{value:"fiber",label:"Fiber"},{value:"tissue",label:"Tissue"},{value:"fabric",label:"Fabric"},{value:"glass",label:"Glass"},{value:"metal",label:"Metal"},{value:"toothpaste tube",label:"Toothpaste Tube"},{value:"other",label:"Other"}],v=[{value:"can",label:"Can"},{value:"tube",label:"Tube"},{value:"box",label:"Box"},{value:"bag",label:"Bag"},{value:"paper",label:"Paper"},{value:"bottle",label:"Bottle"},{value:"cup",label:"Cup"},{value:"straw",label:"Straw"},{value:"foil",label:"Foil"},{value:"wrapper",label:"Wrapper"},{value:"roll",label:"Roll"},{value:"sheet",label:"Sheet"},{value:"tray",label:"Tray"},{value:"pouch",label:"Pouch"},{value:"packet",label:"Packet"},{value:"blister pack",label:"Blister Pack"},{value:"sachet",label:"Sachet"},{value:"envelope",label:"Envelope"},{value:"cylinder",label:"Cylinder"},{value:"disc",label:"Disc"},{value:"stick",label:"Stick"},{value:"mesh",label:"Mesh"},{value:"coil",label:"Coil"},{value:"fragment",label:"Fragment"},{value:"lid",label:"Lid"},{value:"cap",label:"Cap"},{value:"other",label:"Other"}],g=e=>{let{isOpen:l,onClose:a,apiUrl:s,setUploadStatus:n}=e,[o,d]=(0,r.useState)({}),[c,u]=(0,r.useState)(null),[m,g]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[y,w]=(0,r.useState)(null),[N,C]=(0,r.useState)(null),[k,S]=(0,r.useState)(null),P=e=>{d({...o,[e.target.name]:e.target.value})},E=async()=>{if(!c){C("Please select a file to upload.");return}g(!0),C(null),n(null);let e=new FormData;e.append("image",c),Object.entries(o).forEach(l=>{let[a,t]=l;t&&e.append(a,t)});try{let l=await b.Z.post("".concat(s,"/new"),e,{headers:{"Content-Type":"multipart/form-data"}});w(l.data.metadata)}catch(e){console.error("Upload error:",e),C("Upload failed. Please try again.")}finally{g(!1)}},_=async e=>{try{await b.Z.post("".concat(s,"/delete"),{embedding_id:e}),B()}catch(e){console.error("Error undoing the upload:",e)}},B=()=>{d({brand:"",color:"",material:"",shape:"",comment:""}),u(null),S(null),C(null),w(null),j(!1),a()};return l?(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white w-96 rounded-lg shadow-lg p-6 relative",children:[(0,t.jsx)("button",{className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 focus:outline-none",onClick:B,children:"\xd7"}),y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Upload Summary"}),(0,t.jsx)(i(),{src:y.presigned_url,alt:"Uploaded",className:"w-full h-auto mb-4 rounded"}),(0,t.jsxs)("div",{className:"text-sm text-gray-700 space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Color:"})," ",y.color||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Material:"})," ",y.material||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Brand:"})," ",y.brand||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Shape:"})," ",y.shape||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Comment:"})," ",y.comment||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Timestamp:"})," ",y.timestamp||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Robot:"})," ",y.robot||"N/A"]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Date Taken:"})," ",y.datetime_taken||"N/A"]})]}),(0,t.jsxs)("div",{className:"mt-6 flex justify-end space-x-4",children:[(0,t.jsx)("button",{onClick:()=>_(y.embedding_id),className:"px-4 py-2 text-sm font-medium text-gray-600 bg-gray-200 rounded hover:bg-gray-300",children:"Undo"}),(0,t.jsx)("button",{onClick:B,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-gray-200 rounded hover:bg-gray-300",children:"Close"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Upload New Image"}),(0,t.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Select Image"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let l=e.target.files[0];u(l);let a=new FileReader;a.onloadend=()=>{S(a.result)},a.readAsDataURL(l)}},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),k&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Image Preview"}),(0,t.jsx)(i(),{src:k,alt:"Preview",className:"w-48 h-auto mt-2 rounded-lg"})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Color"}),(0,t.jsxs)("select",{name:"color",value:o.color||"",onChange:P,className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Select a color"}),p.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Material"}),(0,t.jsxs)("select",{name:"material",value:o.material||"",onChange:P,className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Select a material"}),x.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Brand"}),(0,t.jsxs)("select",{name:"brand",value:f?"Other":o.brand||"",onChange:e=>{let l=e.target.value;"Other"===l?(j(!0),d({...o,brand:""})):(j(!1),d({...o,brand:l}))},className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Select a brand"}),h.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]}),f&&(0,t.jsx)("input",{type:"text",name:"brand",placeholder:"Enter custom brand",value:o.brand||"",onChange:e=>{d({...o,brand:e.target.value})},className:"block w-full mt-2 p-2 border border-gray-300 rounded-md shadow-sm"})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Shape"}),(0,t.jsxs)("select",{name:"shape",value:o.shape||"",onChange:P,className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm",children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Select a shape"}),v.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Comment"}),(0,t.jsx)("input",{type:"text",name:"comment",value:o.comment||"",onChange:P,placeholder:"Enter your comment",className:"block w-full p-2 border border-gray-300 rounded-md shadow-sm"})]}),(0,t.jsxs)("div",{className:"mt-6 flex justify-end space-x-4",children:[N&&(0,t.jsx)("div",{className:"mt-4 text-sm text-red-500",children:N}),(0,t.jsx)("button",{onClick:B,className:"px-4 py-2 text-sm font-medium text-gray-600 bg-gray-200 rounded hover:bg-gray-300",children:"Cancel"}),(0,t.jsx)("button",{onClick:E,disabled:m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700 ".concat(m?"opacity-50 cursor-not-allowed":""),children:m?"Uploading...":"Upload"})]})]})]})}):null},f=a(3504),j=a(981),y=a.n(j),w=a(4033),N=a(4267);a(1921);var C=a(6325),k=a.n(C),S=a(5507),P=a.n(S),E=a(9817);function _(e){let{children:l}=e;return(0,t.jsxs)("html",{lang:"en",children:[(0,t.jsxs)("head",{children:[(0,t.jsx)("title",{children:"Universal database of objects"}),(0,t.jsx)("meta",{name:"description",content:"Universal database of objects is an app built with Pinecone, Google Multimodal Embedding Model, and Next.js."})]}),(0,t.jsxs)("body",{className:"".concat(k().variable," ").concat(P().variable),children:[l,(0,t.jsx)(E.Analytics,{})]})]})}a(4735);let B=e=>new Promise((l,a)=>{let t=new FileReader;t.onload=t=>{var r;let s=new Image;s.onload=()=>{let t=document.createElement("canvas"),r=t.getContext("2d");if(t.width=512,t.height=512,r){let n,o,i,d;s.width>s.height?(i=d=s.height,n=(s.width-i)/2,o=0):(d=i=s.width,n=0,o=(s.height-d)/2),r.drawImage(s,n,o,i,d,0,0,512,512),t.toBlob(e=>{e?l(e):a(Error("Failed to crop image"))},e.type)}else a(Error("Failed to get canvas context"))},s.onerror=()=>{a(Error("Failed to load image"))},s.src=null===(r=t.target)||void 0===r?void 0:r.result},t.onerror=()=>{a(Error("Failed to read file"))},t.readAsDataURL(e)}),D=async(e,l)=>{let{API_URL:a,setSearchType:t,setErrorMessage:r,setIsUploading:s,setIsSearchComplete:n,setSearchTime:o,setIsLoadingResults:i,setResults:d,setQuery:c,setIsInputEmpty:u,setIsSearching:m}=l,h=e.type.startsWith("image/"),p=e.type.startsWith("video/"),x=h?"".concat(a,"/api/search/image"):"".concat(a,"/api/search/video");if(t(h?"image":"video"),!h&&!p){r("Oops, you uploaded an unsupported file type. Please upload an image or video.");return}if(h){var v;let l=["bmp","gif","jpeg","png","jpg"],a=null===(v=e.name.split(".").pop())||void 0===v?void 0:v.toLowerCase();if(!a||!l.includes(a)){r("We don't support this image format: ".concat(a||"unknown",". Please upload an image in one of the following formats: ").concat(l.join(", "),"."));return}}if(p&&e.size>45e5){r("We're sorry, the video file is too large. Maximum allowed size is 4.5 MB due to hosting limitations. Your file is ".concat((e.size/1048576).toFixed(2)," MB."));return}s(!0),n(!1),o(null),r(null),i(!0);let g=Date.now();try{let l=e;if(h&&e.size>45e5){let a=await B(e);l=new File([a],e.name,{type:e.type})}let a=new FormData;a.append("file",l);let t=await b.Z.post(x,a,{headers:{"Content-Type":"multipart/form-data"}}),r=Date.now();d(t.data.results),o(r-g),(0,f.j)("file_uploaded",{fileType:h?"image":"video",fileName:e.name,originalSize:e.size,compressedSize:l.size}),n(!0),c(""),u(!0)}catch(l){A(l,e.size,r)}finally{m(!1),s(!1),i(!1)}},A=(e,l,a)=>{if((0,f.j)("search_error",{searchType:e.searchType,errorMessage:e instanceof Error?e.message:"Unknown error"}),console.error("Error during file upload:",e),b.Z.isAxiosError(e)){var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===413){if(l>45e5){a("We're very sorry, but we can't upload files larger than 4.5 MB due to hosting limitations. Your file is ".concat((l/1048576).toFixed(1)," MB. Please try a smaller file or compress this one."));return}}else a(e.response?"Oops! ".concat(e.message):"Oops! An unexpected error occurred. Our engineers have been notified.")}else console.error("Unknown error:",e),a("Oops! An unexpected error occurred. Our engineers have been notified.")};var T=()=>(0,t.jsx)("div",{className:"w-full mt-auto py-4 text-center text-gray-500 text-sm",children:(0,t.jsx)("p",{children:"Built by Glacier using FastAPI, Pinecone, Next.js, React, and CLIP (OpenAI)."})}),F=a(5566);let L=(()=>{switch(F.env.NEXT_PUBLIC_VERCEL_ENV){case"development":return F.env.NEXT_PUBLIC_DEVELOPMENT_URL||"http://localhost:8000";case"production":return F.env.NEXT_PUBLIC_PRODUCTION_URL||"http://ec2-54-244-26-92.us-west-2.compute.amazonaws.com:8000";default:return"http://localhost:8000"}})();function O(){let[e,l]=(0,r.useState)(""),[a,o]=(0,r.useState)([]),[i,c]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[p,x]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1),[C,k]=(0,r.useState)(null),[S,P]=(0,r.useState)(!1),[E,B]=(0,r.useState)(null),[A,O]=(0,r.useState)(null),[U,M]=(0,r.useState)(!0),[R,I]=(0,r.useState)(null),[z,W]=(0,r.useState)(!1),[H,G]=(0,r.useState)(!1),[Z,V]=(0,r.useState)("");(0,w.useRouter)();let Y=Z?a.filter(e=>e.metadata.class===Z):a,K=()=>{l(""),o([]),M(!0),P(!1),B(null),O(null),I(null)},q=(0,r.useRef)({}),[J,X]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=!1,l=()=>{let l=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100;l>50&&!e&&((0,f.j)("scroll_depth",{depth:"50%"}),e=!0)};return window.addEventListener("scroll",l),()=>window.removeEventListener("scroll",l)},[]),(0,r.useEffect)(()=>{let e={timestamp:new Date().toISOString(),screenSize:"".concat(window.screen.width,"x").concat(window.screen.height),deviceType:/Mobi|Android/i.test(navigator.userAgent)?"mobile":"desktop",browserName:navigator.userAgent,referrer:document.referrer,loadTime:performance.now(),language:navigator.language,totalVectors:C,appVersion:F.env.NEXT_PUBLIC_APP_VERSION||"unknown"};(0,f.j)("page_viewed",e)},[C]),(0,r.useEffect)(()=>{let e=async()=>{try{let e=await b.Z.get("".concat(L,"/api/index/info"));k(e.data.total_vectors)}catch(e){console.error("Error fetching total vectors:",e)}};e()},[]),(0,r.useEffect)(()=>()=>{Object.values(q.current).forEach(e=>{e&&"function"==typeof e.dispose&&e.dispose()}),q.current={}},[]),(0,r.useEffect)(()=>(a.forEach((e,l)=>{if("video"===e.metadata.file_type){let a=es(e,l),t=document.getElementById(a);if(t&&!q.current[a]){let l=(0,N.Z)(t,{aspectRatio:"1:1",fluid:!0,controls:!0,muted:!0,preload:"auto"});l.one("ready",()=>{l.currentTime(e.metadata.start_offset_sec)}),q.current[a]=l}}}),()=>{Object.keys(q.current).forEach(e=>{a.some((l,a)=>es(l,a)===e)||(q.current[e].dispose(),delete q.current[e])})}),[a]);let Q=()=>{o([]),P(!1),B(null),O(null),I(null)},$=async l=>{if(l.preventDefault(),U)return;G(!1),Q(),x(!0),P(!1),B(null),O("text"),I(null),W(!0);let a=Date.now();try{let l=await b.Z.post("".concat(L,"/api/search/text"),{query:e});o(l.data.results);let t=Date.now();B(t-a),P(!0),(0,f.j)("search_results",{searchType:A,query:e,searchTime:E})}catch(e){console.error("Error during text search:",e),b.Z.isAxiosError(e)&&e.response?I("Oops! ".concat(e.response.data.detail||"An unexpected error occurred")):I("Oops! An unexpected error occurred. Our engineers have been notified.")}finally{x(!1),W(!1)}},ee=async e=>{Q(),await D(e,{API_URL:L,setSearchType:O,setErrorMessage:I,setIsUploading:c,setIsSearchComplete:P,setSearchTime:B,setIsLoadingResults:W,setResults:o,setQuery:l,setIsInputEmpty:M,setIsSearching:x})},el=async e=>{e.target.files&&e.target.files[0]&&((0,f.j)("file_selected"),await ee(e.target.files[0]))},ea=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),j(!0)},[]),et=(0,r.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),j(!1)},[]),er=async e=>{e.preventDefault(),e.stopPropagation(),j(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&((0,f.j)("file_dropped"),await ee(e.dataTransfer.files[0]))},es=(e,l)=>"video-".concat(l,"-").concat(e.metadata.s3_file_path);return(0,t.jsxs)(_,{children:[(0,t.jsx)(y(),{children:(0,t.jsx)("title",{children:"Universal Database of Images"})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-start min-h-screen bg-gray-100 ".concat(v?"border-4 border-dashed border-blue-500":""),onDragOver:ea,onDragLeave:et,onDrop:er,style:{fontFamily:"'Inter', 'Helvetica', 'Arial', sans-serif"},children:[(0,t.jsxs)("div",{className:"max-w-6xl w-full px-4 md:px-0 mt-12",children:[(0,t.jsx)(n,{}),(0,t.jsxs)("div",{className:"max-w-xl mx-auto relative ",children:[(0,t.jsx)(m,{query:e,handleInputChange:e=>{let a=e.target.value;l(a),M(""===a.trim()),G(""!==a.trim())},handleSubmit:$,handleFileChange:el,isInputEmpty:U,isUploading:i,isSearching:p,clearResults:K,suggestions:["red coke can","green plastic","cardboard"],handleSuggestionClick:e=>{l(e),M(!1),G(!1)},showSuggestions:H,handleFocus:()=>{G(!0)},openModal:()=>X(!0)}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(s,{selectedClass:Z,onClassChange:e=>{V(e.target.value)},availableClasses:Array.from(new Set(a.map(e=>e.metadata.class).filter(e=>void 0!==e)))})}),R&&(0,t.jsx)("div",{className:"w-full mt-4 text-red-500 text-center",children:R}),(i||p)&&(0,t.jsxs)("div",{className:"w-full mt-8 flex items-center justify-center",children:[(0,t.jsx)("span",{className:"text-gray-500 pulse",children:i?"Uploading, embedding, and searching...":"Searching..."}),(0,t.jsx)("div",{className:"ml-3 spinner border-4 border-t-transparent border-indigo-300 rounded-full w-6 h-6 animate-spin"})]})]}),u&&(0,t.jsx)("div",{className:"mt-4 p-2 rounded ".concat(u.includes("successful")?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:u}),(0,t.jsxs)("div",{children:[S&&null!==E&&null!==C&&(0,t.jsxs)("div",{className:"ml-1 mt-6 mb-2 flex items-center text-left text-gray-700",children:[(0,t.jsxs)("p",{children:["Searched ",C.toLocaleString()," objects","text"===A&&(0,t.jsxs)(t.Fragment,{children:[" ","for ",(0,t.jsx)("strong",{className:"text-indigo-800",children:e})]}),"image"===A&&(0,t.jsxs)(t.Fragment,{children:[" ","for"," ",(0,t.jsx)("strong",{className:"text-indigo-800",children:"your image"})]}),"video"===A&&(0,t.jsxs)(t.Fragment,{children:[" ","for"," ",(0,t.jsx)("strong",{className:"text-indigo-800",children:"your video"})]})]}),(0,t.jsx)("button",{type:"button",onClick:K,className:"text-gray-400 hover:text-gray-500 mb-0.4 ml-2 focus:outline-none",disabled:i||p,children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,t.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})})]}),(0,t.jsx)(d,{isLoadingResults:z,results:Y,getScoreLabel:e=>({score:e.toFixed(4)}),getVideoId:es})]})]}),(0,t.jsx)(g,{isOpen:J,onClose:()=>X(!1),apiUrl:"".concat(L,"/api"),setUploadStatus:h}),(0,t.jsx)(T,{})]})]})}},4735:function(){}},function(e){e.O(0,[532,709,125,971,596,744],function(){return e(e.s=2555)}),_N_E=e.O()}]);